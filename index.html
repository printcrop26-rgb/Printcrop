<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>PrintCrop – Free Label Tool</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- PDF-LIB -->
<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont;
  background:linear-gradient(180deg,#0b132b,#1c2541);
  color:#fff;
}
.container{
  max-width:420px;
  margin:auto;
  padding:20px;
}
h1{
  text-align:center;
  margin-bottom:5px;
}
.badge{
  text-align:center;
  color:#00ff99;
  font-weight:600;
  margin-bottom:20px;
}
.card{
  background:#111827;
  border-radius:14px;
  padding:18px;
  margin-bottom:18px;
  box-shadow:0 10px 30px rgba(0,0,0,.4);
}
label{font-weight:600}
.option{
  display:flex;
  align-items:center;
  gap:10px;
  margin:10px 0;
}
button{
  width:100%;
  padding:14px;
  font-size:16px;
  font-weight:700;
  border:none;
  border-radius:10px;
  background:#38bdf8;
  color:#000;
  cursor:pointer;
}
button:active{transform:scale(.98)}
.footer{
  text-align:center;
  font-size:13px;
  opacity:.7;
}
</style>
</head>

<body>
<div class="container">

<h1>PrintCrop</h1>
<div class="badge">100% Free • No Login</div>

<div class="card">
  <label>Select Company</label>
  <div class="option"><input type="radio" name="company" value="meesho"> Meesho</div>
  <div class="option"><input type="radio" name="company" value="amazon"> Amazon</div>
  <div class="option"><input type="radio" name="company" value="flipkart"> Flipkart</div>
</div>

<div class="card">
  <label>Print Mode</label>
  <div class="option"><input type="radio" name="mode" value="a4" checked> A4 (Auto Layout)</div>
  <div class="option"><input type="radio" name="mode" value="thermal"> Thermal 4×6</div>
</div>

<div class="card">
  <label>Upload Label PDF</label><br><br>
  <input type="file" id="fileInput" accept="application/pdf">
</div>

<button onclick="generatePDF()">Download Cropped PDF</button>

<div class="footer"><br>Ads-Ready • Professional Output</div>

</div>

<script>
async function generatePDF(){
  const file = document.getElementById('fileInput').files[0];
  if(!file){ alert("Upload PDF"); return; }

  const company = document.querySelector('input[name="company"]:checked');
  if(!company){ alert("Select company"); return; }

  const mode = document.querySelector('input[name="mode"]:checked').value;

  const bytes = await file.arrayBuffer();
  const srcPdf = await PDFLib.PDFDocument.load(bytes);
  const pages = srcPdf.getPages();

  const outPdf = await PDFLib.PDFDocument.create();

  const A4_W = 595.28;
  const A4_H = 841.89;

  let perPage = mode==="thermal" ? 1 : 4;

  for(let i=0;i<pages.length;i+=perPage){
    const page = outPdf.addPage([A4_W,A4_H]);

    const slice = pages.slice(i,i+perPage);

    let rows=1, cols=1;
    if(slice.length===2){rows=1;cols=2;}
    if(slice.length>=3){rows=2;cols=2;}

    const cellW = A4_W/cols;
    const cellH = A4_H/rows;

    for(let j=0;j<slice.length;j++){
      const src = slice[j];
      const embed = await outPdf.embedPage(src);

      const scale = Math.min(
        cellW/embed.width,
        cellH/embed.height
      );

      const col = j%cols;
      const row = Math.floor(j/cols);

      const x = col*cellW + (cellW - embed.width*scale)/2;
      const y = A4_H - (row+1)*cellH + (cellH - embed.height*scale)/2;

      page.drawPage(embed,{x,y,scale});
    }
  }

  const out = await outPdf.save();
  const blob = new Blob([out],{type:"application/pdf"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "PrintCrop_Output.pdf";
  a.click();
}
</script>
</body>
</html>
