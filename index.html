<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>printcrop â€“ Free Label Tool</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,sans-serif}
body{background:linear-gradient(180deg,#0b1e2d,#0f2f46);color:#fff}
.container{max-width:480px;margin:auto;padding:20px}

header{background:#fff;color:#000;padding:14px;text-align:center}
h1{color:#1e3a8a;font-size:24px}

.card{background:#fff;color:#000;border-radius:18px;padding:20px;margin-top:20px}

.company{border:2px solid #e5e7eb;border-radius:14px;padding:14px;text-align:center;margin-bottom:10px;cursor:pointer}
.company.active{border-color:#2da4ff;background:#f0f9ff}

.options{display:flex;gap:10px;margin:16px 0}
.options label{border:2px solid #e5e7eb;padding:10px 16px;border-radius:999px;cursor:pointer}
input{display:none}
input:checked+label{border-color:#2da4ff;background:#f0f9ff}

.upload{border:2px dashed #94a3b8;padding:20px;text-align:center;border-radius:14px;margin-bottom:16px}

button{
  width:100%;
  background:linear-gradient(135deg,#2563eb,#38bdf8);
  color:#fff;
  padding:16px;
  font-size:17px;
  border:none;
  border-radius:14px;
  cursor:pointer
}
button:active{transform:scale(.97)}
</style>
</head>

<body>

<header><h1>printcrop</h1></header>

<div class="container card">

<h3>Select Company</h3>
<div class="company" data-c="Amazon">Amazon</div>
<div class="company" data-c="Flipkart">Flipkart</div>
<div class="company" data-c="Meesho">Meesho</div>

<h3 style="margin-top:18px">Select Print Type</h3>
<div class="options">
  <input type="radio" id="a4" name="p" checked>
  <label for="a4">A4 Sheet</label>

  <input type="radio" id="lp" name="p">
  <label for="lp">Label Printer</label>
</div>

<div class="upload">
  <b>Upload Label PDF</b><br><br>
  <input type="file" id="pdf" accept="application/pdf">
</div>

<button id="download">Download Final PDF</button>

</div>

<script>
const { PDFDocument } = PDFLib;
let company=null;

document.querySelectorAll('.company').forEach(c=>{
  c.onclick=()=>{
    document.querySelectorAll('.company').forEach(x=>x.classList.remove('active'));
    c.classList.add('active');
    company=c.dataset.c;
  }
});

document.getElementById('download').onclick = async () => {
  if(!company) return alert("Select company");
  const file=document.getElementById('pdf').files[0];
  if(!file) return alert("Upload PDF");

  const srcBytes=await file.arrayBuffer();
  const srcPdf=await PDFDocument.load(srcBytes);
  const outPdf=await PDFDocument.create();
  const pages=await outPdf.copyPages(srcPdf,srcPdf.getPageIndices());

  const W=595,H=842; let buf=[];
  pages.forEach((p,i)=>{
    buf.push(p);
    if(buf.length===4 || i===pages.length-1){
      const pg=outPdf.addPage([W,H]);
      [[0,H/2],[W/2,H/2],[0,0],[W/2,0]].forEach((s,j)=>{
        if(buf[j]){
          const sc=Math.min((W/2)/buf[j].getWidth(),(H/2)/buf[j].getHeight());
          pg.drawPage(buf[j],{x:s[0],y:s[1],scale:sc});
        }
      });
      buf=[];
    }
  });

  const blob=new Blob([await outPdf.save()],{type:"application/pdf"});
  const url=URL.createObjectURL(blob);

  const iframe=document.createElement("iframe");
  iframe.style.display="none";
  iframe.src=url;
  document.body.appendChild(iframe);

  setTimeout(()=>URL.revokeObjectURL(url),4000);
};
</script>

</body>
</html>
