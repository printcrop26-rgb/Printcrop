<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Printcrop | Official Website</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #ffffff;
}

.app {
  max-width: 420px;
  margin: 0 auto;
  padding: 20px;
}

.title {
  text-align: center;
  font-size: 28px;
  margin-bottom: 6px;
}

.subtitle {
  text-align: center;
  font-size: 14px;
  opacity: 0.8;
  margin-bottom: 20px;
}

.card {
  background: rgba(255,255,255,0.05);
  border: 1px solid #38bdf8;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 16px;
}

.card h2 {
  font-size: 16px;
  margin-bottom: 12px;
}

.radio {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
  cursor: pointer;
}

.radio input {
  accent-color: #38bdf8;
}

.file-input {
  width: 100%;
  margin-bottom: 10px;
}

.textarea {
  width: 100%;
  min-height: 120px;
  border-radius: 8px;
  border: none;
  padding: 10px;
  font-size: 13px;
}

.or {
  text-align: center;
  font-size: 12px;
  opacity: 0.6;
  margin: 8px 0;
}

.primary-btn {
  width: 100%;
  padding: 14px;
  border-radius: 10px;
  border: none;
  background: #38bdf8;
  color: #000;
  font-weight: bold;
  font-size: 16px;
}
  </style>
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
</head>
<body>
<div class="app">
  <h1 class="title">üñ®Ô∏è Printcrop</h1>
  <p class="subtitle">Smart Shipping Label Tool</p>
<div class="card">
  <h2>0Ô∏è‚É£ Select Company</h2>

  <label class="radio">
    <input type="radio" name="company" value="meesho">
    <span>Meesho</span>
  </label>

  <label class="radio">
    <input type="radio" name="company" value="amazon">
    <span>Amazon</span>
  </label>

  <label class="radio">
    <input type="radio" name="company" value="flipkart">
    <span>Flipkart</span>
  </label>
</div>
  

  <div class="card">
    <h2>1Ô∏è‚É£ Select Print Mode</h2>

    <label class="radio">
      <input type="radio" name="mode"
      value="a4">
      <span>A4 Paper (4 Labels per page)</span>
    </label>

    <label class="radio">
      <input type="radio" name="mode"
      value="thermal">
      <span>Label Printer (Thermal)</span>
    </label>
  </div>

  <div class="card">
    <h2>2Ô∏è‚É£ Upload or Paste Label PDF</h2>

    <input type="file" class="file-input">

    <p class="or">OR</p>

    <textarea class="textarea"
      placeholder="Paste Meesho / Flipkart label text here">
    </textarea>
  </div>

  <div class="card">
    <button class="primary-btn" onclick="generatePDF()">
  Generate & Download PDF
</button>
  </div>

  <script>
async function generatePDF() {
alert("generatePDF function called");
  const company = document.querySelector('input[name="company"]:checked');
  const mode = document.querySelector('input[name="mode"]:checked');
  const fileInput = document.querySelector('.file-input');

  if (!company) {
    alert("‚ùå Company select karo (Meesho / Amazon / Flipkart)");
    return;
  }

  if (!mode) {
    alert("‚ùå Print mode select karo (A4 / Label Printer)");
    return;
  }

  if (!fileInput.files.length) {
    alert("‚ùå PDF file upload karo");
    return;
  }

  alert(
    "‚úÖ Company: " + company.value +
    "\n‚úÖ Mode: " + mode.value +
    "\n‚úÖ File selected\n\nNext step: Crop logic"
  );
  // ===== THERMAL LABEL SIZE (FINAL) =====
if (company.value === "meesho" && mode.value === "thermal") {

  alert(
    "üß† Crop Logic Active\n\n" +
    "Company: Meesho\n" +
    "Mode: Thermal (4 x 6 inch)\n\n" +
    "‡§Ö‡§¨ 1 label = 1 page ‡§¨‡§®‡•á‡§ó‡§æ"
  );

  // FINAL LABEL SIZE
  const LABEL_WIDTH_INCH = 4;
  const LABEL_HEIGHT_INCH = 6;

  // PDF points (important)
  const LABEL_WIDTH = 4 * 72;   // 288
  const LABEL_HEIGHT = 6 * 72;  // 432

  console.log("Thermal label size:", LABEL_WIDTH, LABEL_HEIGHT);

 // ===== REAL THERMAL PDF PROCESS START =====

const file = fileInput.files[0];
const reader = new FileReader();

reader.onload = async function () {
  const existingPdfBytes = reader.result;

  const pdfDoc = await PDFLib.PDFDocument.load(existingPdfBytes);
  const newPdf = await PDFLib.PDFDocument.create();

  const pages = pdfDoc.getPages();

  for (let i = 0; i < pages.length; i++) {
    const page = pages[i];
    const { width, height } = page.getSize();

    const newPage = newPdf.addPage([LABEL_WIDTH, LABEL_HEIGHT]);

    const embeddedPage = await newPdf.embedPage(page);

    newPage.drawPage(embeddedPage, {
      x: 0,
      y: 0,
      width: LABEL_WIDTH,
      height: LABEL_HEIGHT,
    });
  }

  const pdfBytes = await newPdf.save();
  const blob = new Blob([pdfBytes], { type: "application/pdf" });

  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "meesho-thermal-label.pdf";
  link.click();
};

reader.readAsArrayBuffer(file);

// ===== REAL THERMAL PDF PROCESS END ===== 

}
  // ---- CROP LOGIC START (MEESHO + A4) ----
if (company.value === "meesho" && mode.value === "a4") {
  
  console.log("MEESHO A4 LOGIC START");
  const existingPdfBytes = await file.arrayBuffer();
const pdfDoc = await PDFLib.PDFDocument.load(existingPdfBytes);

// A4 page size in points
const A4_WIDTH = 595;
const A4_HEIGHT = 842;

// Create new PDF
const newPdf = await PDFLib.PDFDocument.create();

// Label size (4 labels per page)
const LABEL_WIDTH = A4_WIDTH / 2;
const LABEL_HEIGHT = A4_HEIGHT / 2;

const pages = pdfDoc.getPages();

for (let i = 0; i < pages.length; i++) {
  const srcPage = pages[i];

  for (let row = 0; row < 2; row++) {
    for (let col = 0; col < 2; col++) {
      const [embeddedPage] = await newPdf.embedPages([srcPage], [{
        x: col * LABEL_WIDTH,
        y: A4_HEIGHT - (row + 1) * LABEL_HEIGHT,
        width: LABEL_WIDTH,
        height: LABEL_HEIGHT,
      }]);

      const page = newPdf.addPage([LABEL_WIDTH, LABEL_HEIGHT]);
      page.drawPage(embeddedPage, {
        x: 0,
        y: 0,
        width: LABEL_WIDTH,
        height: LABEL_HEIGHT,
      });
    }
  }
}

// Download
const pdfBytes = await newPdf.save();
const blob = new Blob([pdfBytes], { type: "application/pdf" });
const link = document.createElement("a");
link.href = URL.createObjectURL(blob);
link.download = "meesho-a4-4-labels.pdf";
link.click();
}
// ---- CROP LOGIC END ----
}
</script>
</body>
</html>
