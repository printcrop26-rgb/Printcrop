<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PrintCrop – Smart Label Tool</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- PDF LIB -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>

<style>
body {
  margin: 0;
  font-family: Inter, Arial, sans-serif;
  background: #0f172a;
  color: #fff;
}

.container {
  max-width: 420px;
  margin: auto;
  padding: 20px;
}

.header {
  text-align: center;
  margin-bottom: 20px;
}

.header h1 {
  font-size: 28px;
  margin: 0;
}

.badge {
  display: inline-block;
  background: #16a34a;
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 12px;
  margin-top: 8px;
}

.card {
  background: #020617;
  border-radius: 14px;
  padding: 16px;
  margin-bottom: 16px;
  border: 1px solid #1e293b;
}

.card h3 {
  margin: 0 0 10px;
  font-size: 15px;
}

.brands {
  display: flex;
  justify-content: space-around;
  margin-top: 8px;
}

.brand {
  font-weight: bold;
}

.meesho { color: #ec4899; }
.amazon { color: #f59e0b; }
.flipkart { color: #3b82f6; }

input[type=file] {
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: #020617;
  color: #fff;
}

button {
  width: 100%;
  padding: 16px;
  font-size: 16px;
  font-weight: bold;
  border-radius: 12px;
  border: none;
  background: linear-gradient(135deg,#38bdf8,#2563eb);
  color: #fff;
  cursor: pointer;
}

.footer {
  text-align: center;
  font-size: 12px;
  opacity: 0.6;
  margin-top: 20px;
}
</style>
</head>

<body>

<div class="container">

  <div class="header">
    <h1>PrintCrop</h1>
    <div class="badge">100% Free • No Login</div>
  </div>

  <div class="card">
    <h3>Upload Label PDF</h3>
    <input type="file" id="pdfFile" accept="application/pdf">
    <div class="brands">
      <div class="brand meesho">Meesho</div>
      <div class="brand amazon">Amazon</div>
      <div class="brand flipkart">Flipkart</div>
    </div>
  </div>

  <button onclick="processPDF()">Generate A4 PDF (Download)</button>

  <div class="footer">
    Smart label arranger • Future Ads supported
  </div>

</div>

<script>
async function processPDF() {
  const fileInput = document.getElementById("pdfFile");
  if (!fileInput.files.length) {
    alert("Please upload label PDF");
    return;
  }

  const fileBytes = await fileInput.files[0].arrayBuffer();
  const srcPdf = await PDFLib.PDFDocument.load(fileBytes);
  const outPdf = await PDFLib.PDFDocument.create();

  const pages = srcPdf.getPages();
  const A4_WIDTH = 595;
  const A4_HEIGHT = 842;

  let page;
  let slot = 0;

  for (let i = 0; i < pages.length; i++) {

    if (slot === 0) {
      page = outPdf.addPage([A4_WIDTH, A4_HEIGHT]);
    }

    const embedded = await outPdf.embedPage(pages[i]);
    const scale = Math.min(
      (A4_WIDTH / 2) / embedded.width,
      (A4_HEIGHT / 2) / embedded.height
    );

    const positions = [
      { x: 0, y: A4_HEIGHT / 2 },
      { x: A4_WIDTH / 2, y: A4_HEIGHT / 2 },
      { x: 0, y: 0 },
      { x: A4_WIDTH / 2, y: 0 }
    ];

    page.drawPage(embedded, {
      x: positions[slot].x,
      y: positions[slot].y,
      xScale: scale,
      yScale: scale
    });

    slot++;

    if (slot === 4) slot = 0;
  }

  const finalBytes = await outPdf.save();
  const blob = new Blob([finalBytes], { type: "application/pdf" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "PrintCrop_A4_Labels.pdf";
  link.click();
}
</script>

</body>
</html>
