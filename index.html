<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Printcrop – Free Label Tool</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- PDF LIB -->
<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

<style>
body{
  margin:0;
  font-family:Inter,Arial,sans-serif;
  background:#0f172a;
  color:#fff;
}
.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}
h1{
  text-align:center;
  font-size:28px;
  margin-bottom:5px;
}
.tagline{
  text-align:center;
  opacity:.8;
  margin-bottom:20px;
}
.card{
  background:#111827;
  border-radius:12px;
  padding:16px;
  margin-bottom:16px;
}
.brand-row{
  display:flex;
  gap:15px;
  justify-content:center;
}
.brand{
  padding:10px 18px;
  border-radius:8px;
  cursor:pointer;
  border:2px solid transparent;
  font-weight:600;
}
.brand input{display:none;}
.brand.meesho{background:#f43397;}
.brand.amazon{background:#ff9900;color:#000;}
.brand.flipkart{background:#2874f0;}
.brand input:checked + span{
  border-bottom:3px solid #fff;
}

.option{
  display:flex;
  gap:20px;
}
.option label{
  cursor:pointer;
}

input[type=file]{
  width:100%;
  padding:10px;
  background:#020617;
  color:#fff;
  border-radius:8px;
}

button{
  width:100%;
  padding:14px;
  font-size:16px;
  border:none;
  border-radius:10px;
  background:#22c55e;
  color:#000;
  font-weight:700;
  cursor:pointer;
}
button:hover{opacity:.9}

.footer{
  text-align:center;
  font-size:13px;
  opacity:.7;
}
</style>
</head>

<body>
<div class="container">

<h1>Printcrop</h1>
<div class="tagline">Free A4 & Label Printer PDF Tool</div>

<div class="card">
  <h3>Select Company</h3>
  <div class="brand-row">
    <label class="brand meesho">
      <input type="radio" name="company" value="meesho">
      <span>Meesho</span>
    </label>
    <label class="brand amazon">
      <input type="radio" name="company" value="amazon">
      <span>Amazon</span>
    </label>
    <label class="brand flipkart">
      <input type="radio" name="company" value="flipkart">
      <span>Flipkart</span>
    </label>
  </div>
</div>

<div class="card">
  <h3>Select Print Mode</h3>
  <div class="option">
    <label><input type="radio" name="mode" value="a4"> A4 (4 labels max)</label>
    <label><input type="radio" name="mode" value="thermal"> Label Printer (4×6)</label>
  </div>
</div>

<div class="card">
  <h3>Upload Label PDF</h3>
  <input type="file" id="pdfFile" accept="application/pdf">
</div>

<button type="button" onclick="generatePDF()">Generate & Download PDF</button>

<div class="footer">
  100% Free • No Login • No Data Saved
</div>

</div>

<script>
async function generatePDF(){
  const company = document.querySelector('input[name="company"]:checked');
  const mode = document.querySelector('input[name="mode"]:checked');
  const fileInput = document.getElementById("pdfFile");

  if(!company || !mode || !fileInput.files.length) return;

  const bytes = await fileInput.files[0].arrayBuffer();
  const src = await PDFLib.PDFDocument.load(bytes);
  const out = await PDFLib.PDFDocument.create();

  const total = src.getPageCount();

  if(mode.value==="thermal"){
    for(let i=0;i<total;i++){
      const page = out.addPage([288,432]);
      const [p] = await out.copyPages(src,[i]);
      page.drawPage(p,{x:0,y:0,width:288,height:432});
    }
  }

  if(mode.value==="a4"){
    let index=0;
    while(index<total){
      const page = out.addPage([595,842]);
      const remain = total-index;
      const count = Math.min(remain,4);

      let pos=[];
      if(count===1) pos=[{x:149,y:210,w:297,h:421}];
      if(count===2) pos=[
        {x:0,y:210,w:297.5,h:421},
        {x:297.5,y:210,w:297.5,h:421}
      ];
      if(count===3) pos=[
        {x:0,y:421,w:297.5,h:421},
        {x:297.5,y:421,w:297.5,h:421},
        {x:149,y:0,w:297,h:421}
      ];
      if(count===4) pos=[
        {x:0,y:421,w:297.5,h:421},
        {x:297.5,y:421,w:297.5,h:421},
        {x:0,y:0,w:297.5,h:421},
        {x:297.5,y:0,w:297.5,h:421}
      ];

      for(let i=0;i<count;i++){
        const [p]=await out.copyPages(src,[index]);
        page.drawPage(p,pos[i]);
        index++;
      }
    }
  }

  const finalPDF = await out.save();
  const blob = new Blob([finalPDF],{type:"application/pdf"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href=url;
  a.download="printcrop_output.pdf";
  a.click();
}
</script>

</body>
</html>
